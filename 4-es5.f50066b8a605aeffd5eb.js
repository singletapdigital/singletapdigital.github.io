!function(){function e(e,n){for(var o=0;o<n.length;o++){var i=n[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(n,o,i){return o&&e(n.prototype,o),i&&e(n,i),n}function o(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{eNtl:function(e,i,t){"use strict";t.r(i),t.d(i,"BookingPageModule",(function(){return F}));var r=t("pMoy"),s=t("UKGz"),a=t("SVse"),c=t("s7LF"),b=t("sZkV"),l=t("iInd"),u=t("mrSG"),h=function e(){o(this,e),this.personFirstName=new c.c("",[c.n.required,c.n.minLength(3)]),this.personLastName=new c.c("",[c.n.required,c.n.minLength(1)]),this.personPhoneNumber=new c.c("",[c.n.required,c.n.minLength(10),c.n.pattern(/^[+)(\d)]+$/)]),this.personEmailAddress=new c.c("",[c.n.required,c.n.minLength(1),c.n.email]),this.isDeclarationChecked=new c.c("",[c.n.requiredTrue])},d=function(){function e(){o(this,e)}return n(e,null,[{key:"createPersonForm",value:function(){return new h}}]),e}(),g=t("t0hA"),m=t("8Y7J"),f=t("h80k");function p(e,n){if(1&e&&(m.Qb(0,"div"),m.Qb(1,"ion-button",26),m.Lb(2,"ion-icon",27),m.sc(3," Add Person to Booking "),m.Pb(),m.Qb(4,"button",28),m.Lb(5,"ion-icon",29),m.sc(6," Add Person (enter) "),m.Pb(),m.Pb()),2&e){var o=m.cc();m.Ab(1),m.hc("disabled",o.bookingForm.invalid),m.Ab(3),m.hc("disabled",o.bookingForm.invalid)}}function P(e,n){if(1&e){var o=m.Rb();m.Qb(0,"div"),m.Qb(1,"ion-button",30),m.Yb("click",(function(e){m.lc(o);var n=m.cc(),i=m.kc(8);return n.clickSubmitForm(n.bookingEnglishUUID,i,e)})),m.sc(2," Register for Sunday service (English hall) "),m.Pb(),m.Pb()}if(2&e){var i=m.cc();m.Ab(1),m.hc("disabled",i.bookingForm.invalid)}}function v(e,n){1&e&&(m.Qb(0,"ion-text",31),m.sc(1," Registrations reached maximum capacity for English hall "),m.Pb())}function C(e,n){if(1&e){var o=m.Rb();m.Qb(0,"div"),m.Qb(1,"ion-button",30),m.Yb("click",(function(e){m.lc(o);var n=m.cc(),i=m.kc(8);return n.clickSubmitForm(n.bookingChineseUUID,i,e)})),m.sc(2," Register for Sunday service (Chinese hall) "),m.Pb(),m.Pb()}if(2&e){var i=m.cc();m.Ab(1),m.hc("disabled",i.bookingForm.invalid)}}function k(e,n){1&e&&(m.Qb(0,"ion-text",31),m.sc(1," Registrations reached maximum capacity for Chinese hall "),m.Pb())}var Q,y,w,I=[{path:"",component:(Q=function(){function e(n,i,t){o(this,e),this.bookingService=n,this.formBuilder=i,this.toastController=t,this.bookingChineseUUID="445538f0-e22e-4568-acf8-9bc5bba3ceb6",this.bookingEnglishUUID="81508052-8691-4ff4-a3ef-c36bf7fccc88",this.eventChineseUUID="667c1a54-3c59-4eff-a507-b55a80094249",this.eventEnglishUUID="f883134b-661a-4388-b677-582bc2ea39aa",this.latestPersonsEnglishCap=49,this.latestPersonsChineseCap=49;var r=i.group(d.createPersonForm());this.bookingForm=r}return n(e,[{key:"ngOnInit",value:function(){var e=this;console.log("BookingPage -> ngOnInit");var n=Object(g.b)(this.bookingService.getNumberOfPersonBookingsForEvent());this.latestPersonsCountChinese=n,n.subscribe((function(n){e.chineseCount=n}));var o=Object(g.b)(this.bookingService.getNumberOfPersonBookingsForEvent(this.eventEnglishUUID));this.latestPersonsCountEnglish=o,o.subscribe((function(n){return e.englishCount=n}))}},{key:"clickSubmitForm",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"445538f0-e22e-4568-acf8-9bc5bba3ceb6",o=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.bookingForm,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.bookingService;n===this.bookingEnglishUUID?this.englishCount+=1:this.chineseCount+=1,console.log("BookingPage:: clickSubmitForm() -> form",o,i,t);var s=t.value;""!==s.personFirstName?(o.control.setErrors({invalid:"Saving form..."}),r.addPersonToBookingByUUID(n,s).subscribe((function(n){var o,i,t,r;console.log("BookingPage -> clickSubmitForm -> personBookingResult",n),e.presentToast("Successfully saved booking "+(null===(r=null===(t=null===(i=null===(o=null==n?void 0:n.data)||void 0===o?void 0:o.insert_Person)||void 0===i?void 0:i.returning)||void 0===t?void 0:t[0])||void 0===r?void 0:r.personFirstName)).catch(),e.resetRecreateForm()}),(function(n){e.presentToast("Error saving "+JSON.stringify(n)).catch()}))):this.presentToast("Invalid inputs detected").catch()}},{key:"resetRecreateForm",value:function(){var e=this.formBuilder.group(d.createPersonForm());this.bookingForm=e}},{key:"presentToast",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Loading...",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.toastController;return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,n.create({message:e,duration:3500,animated:!0,translucent:!0});case 2:return o.abrupt("return",o.sent.present().then((function(){console.log("Toast presented")})));case 3:case"end":return o.stop()}}),o)})))}},{key:"compare",value:function(e,n){return e<n}},{key:"isEnglishCountCappedLocked",get:function(){return this.englishCount>=this.latestPersonsEnglishCap}},{key:"isChineseCountCappedLocked",get:function(){return this.chineseCount>=this.latestPersonsChineseCap}},{key:"isRegistrationAllowedEnglishCountBelowCap",get:function(){return!this.isEnglishCountCappedLocked}},{key:"isRegistrationAllowedChineseCountBelowCap",get:function(){return!this.isChineseCountCappedLocked}}]),e}(),Q.\u0275fac=function(e){return new(e||Q)(m.Kb(g.a),m.Kb(c.b),m.Kb(b.B))},Q.\u0275cmp=m.Eb({type:Q,selectors:[["app-booking"]],decls:96,vars:16,consts:[[3,"translucent"],["color","cobaltblue"],["slot","start"],[2,"padding-inline-start","0.25em"],[3,"formGroup"],["f","ngForm"],[3,"fixed"],[2,"color","gray"],[2,"--inner-border-width","0"],[2,"text-indent","1em"],[2,"padding-left","1em"],["name","call-outline"],["aria-label","b","formControlName","isDeclarationChecked",2,"padding-left","0.95em"],["size","3"],["lines","full"],["position","floating"],["formControlName","personFirstName","type","text","required",""],["formControlName","personLastName","type","text","required",""],["formControlName","personPhoneNumber","type","text","required",""],["size","4.5"],["formControlName","personEmailAddress","type","text","required",""],[4,"ngIf"],["maxedOut",""],[4,"ngIf","ngIfElse"],["maxedEnglish",""],["maxedChinese",""],["type","button","color","cobaltblue",3,"disabled"],["name","person-add-outline"],["type","button","mat-button","","color","primary","hidden","",3,"disabled"],["name","document-text"],["type","button","color","brightnavyblue",3,"disabled","click"],["color","warning"]],template:function(e,n){if(1&e&&(m.Qb(0,"ion-header",0),m.Qb(1,"ion-toolbar",1),m.Qb(2,"ion-buttons",2),m.Lb(3,"app-home-button"),m.Pb(),m.Qb(4,"ion-title",3),m.sc(5," Booking "),m.Pb(),m.Pb(),m.Pb(),m.Qb(6,"ion-content"),m.Qb(7,"form",4,5),m.Qb(9,"ion-grid",6),m.Qb(10,"ion-row",7),m.Qb(11,"ion-col"),m.sc(12),m.dc(13,"async"),m.Lb(14,"br"),m.sc(15),m.dc(16,"async"),m.Pb(),m.Pb(),m.Qb(17,"ion-row"),m.Qb(18,"ion-col"),m.Qb(19,"ion-card"),m.Qb(20,"ion-card-header"),m.sc(21," Please review the following questions: "),m.Pb(),m.Qb(22,"ion-list"),m.Qb(23,"ion-card"),m.Qb(24,"ion-item",8),m.sc(25," 1. In the last 14 days have you travelled from overseas or a COVID-19 hotspot? "),m.Pb(),m.Qb(26,"ion-item"),m.Qb(27,"span",9),m.sc(28," \u5728\u904e\u53bb\u7684 14 \u5929\u4e2d\uff0c\u60a8\u662f\u5f9e\u6d77\u5916, \u9084\u662f\u5f9e COVID-19 \u71b1\u9ede\u56de\u6765? "),m.Pb(),m.Pb(),m.Pb(),m.Qb(29,"ion-card"),m.Qb(30,"ion-item",8),m.sc(31," 2. Have you been in close contact with a person who is positive for COVID-19? "),m.Pb(),m.Qb(32,"ion-item"),m.Qb(33,"span",9),m.sc(34," \u60a8\u662f\u5426\u8207COVID-19\u68c0\u6d4b\u5448\u967d\u6027\u7684\u4eba\u4fdd\u6301\u5bc6\u5207\u806f\u7e6b? "),m.Pb(),m.Pb(),m.Pb(),m.Qb(35,"ion-card"),m.Qb(36,"ion-item",8),m.sc(37," 3. Are you an active COVID-19 case? "),m.Pb(),m.Qb(38,"ion-item"),m.Qb(39,"span",9),m.sc(40," \u60a8\u662f\u5426\u60a3\u65b0\u51a0\u75c5\u6bd2COVID-19? "),m.Pb(),m.Pb(),m.Pb(),m.Qb(41,"ion-card"),m.Qb(42,"ion-item",8),m.sc(43," 4. Are you currently experiencing, or have you recently experienced cough, fever, sore throat, fatigue or shortness of breath? "),m.Pb(),m.Qb(44,"ion-item"),m.Qb(45,"span",9),m.sc(46," \u60a8\u76ee\u524d\u6216\u6700\u8fd1\u662f\u5426\u6709\u54b3\u55fd\uff0c\u767c\u71d2\uff0c\u5589\u56a8\u75db\uff0c\u75b2\u52de\u6216\u547c\u5438\u6025\u4fc3? "),m.Pb(),m.Pb(),m.Pb(),m.Pb(),m.Pb(),m.Pb(),m.Pb(),m.Qb(47,"ion-row"),m.Qb(48,"ion-col"),m.Qb(49,"span",10),m.sc(50," If yes to any of the above please do not attend church service this week ( "),m.Lb(51,"ion-icon",11),m.sc(52,"13 HEALTH). "),m.Pb(),m.Pb(),m.Pb(),m.Qb(53,"ion-row"),m.Qb(54,"ion-col"),m.Qb(55,"mat-checkbox",12),m.sc(56," By checking this box I declare that I do not have any of these risk factors. "),m.Pb(),m.Pb(),m.Pb(),m.Qb(57,"ion-row"),m.Qb(58,"ion-col",13),m.Qb(59,"ion-item",14),m.Qb(60,"ion-label",15),m.sc(61," First name "),m.Pb(),m.Lb(62,"ion-input",16),m.Pb(),m.Pb(),m.Pb(),m.Qb(63,"ion-row"),m.Qb(64,"ion-col",13),m.Qb(65,"ion-item",14),m.Qb(66,"ion-label",15),m.sc(67," Last name "),m.Pb(),m.Lb(68,"ion-input",17),m.Pb(),m.Pb(),m.Pb(),m.Qb(69,"ion-row"),m.Qb(70,"ion-col",13),m.Qb(71,"ion-item",14),m.Qb(72,"ion-label",15),m.sc(73," Phone number "),m.Pb(),m.Lb(74,"ion-input",18),m.Pb(),m.Pb(),m.Pb(),m.Qb(75,"ion-row"),m.Qb(76,"ion-col",19),m.Qb(77,"ion-item",14),m.Qb(78,"ion-label",15),m.sc(79," Email address "),m.Pb(),m.Lb(80,"ion-input",20),m.Pb(),m.Pb(),m.Pb(),m.Qb(81,"ion-row"),m.Qb(82,"ion-col"),m.qc(83,p,7,2,"div",21),m.Pb(),m.Pb(),m.Qb(84,"ion-row"),m.Qb(85,"ion-col"),m.Mb(86,null,22),m.qc(88,P,3,1,"div",23),m.qc(89,v,2,0,"ng-template",null,24,m.rc),m.Pb(),m.Pb(),m.Qb(91,"ion-row"),m.Qb(92,"ion-col"),m.qc(93,C,3,1,"div",23),m.Pb(),m.Pb(),m.qc(94,k,2,0,"ng-template",null,25,m.rc),m.Pb(),m.Pb(),m.Pb()),2&e){var o=m.kc(90),i=m.kc(95);m.hc("translucent",!0),m.Ab(7),m.hc("formGroup",n.bookingForm),m.Ab(2),m.hc("fixed",!0),m.Ab(3),m.uc(" Current English hall registration count: ",m.ec(13,12,n.latestPersonsCountEnglish)," out of maximum ",n.latestPersonsEnglishCap," "),m.Ab(3),m.uc(" Current Chinese hall registration count: ",m.ec(16,14,n.latestPersonsCountChinese)," out of maximum ",n.latestPersonsChineseCap," "),m.Ab(68),m.hc("ngIf",n.isRegistrationAllowedEnglishCountBelowCap&&n.isRegistrationAllowedChineseCountBelowCap),m.Ab(5),m.hc("ngIf",n.isRegistrationAllowedEnglishCountBelowCap)("ngIfElse",o),m.Ab(5),m.hc("ngIf",n.isRegistrationAllowedChineseCountBelowCap)("ngIfElse",i)}},directives:[b.j,b.w,b.c,f.a,b.v,b.g,c.o,c.k,c.e,b.i,b.q,b.f,b.d,b.e,b.o,b.m,b.k,r.a,c.j,c.d,b.n,b.l,b.A,c.m,a.j,b.b,b.u],pipes:[a.b],styles:[""]}),Q)}],E=((w=function e(){o(this,e)}).\u0275mod=m.Ib({type:w}),w.\u0275inj=m.Hb({factory:function(e){return new(e||w)},imports:[[l.i.forChild(I)],l.i]}),w),F=((y=function e(){o(this,e)}).\u0275mod=m.Ib({type:y}),y.\u0275inj=m.Hb({factory:function(e){return new(e||y)},imports:[[a.c,c.f,c.l,b.x,s.a,r.b,E]]}),y)}}])}();