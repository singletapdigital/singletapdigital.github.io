(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{eNtl:function(n,e,o){"use strict";o.r(e),o.d(e,"BookingPageModule",(function(){return v}));var i=o("UKGz"),t=o("SVse"),s=o("s7LF"),r=o("sZkV"),c=o("iInd"),b=o("mrSG");class l{constructor(){this.personFirstName=new s.c("",[s.n.required,s.n.minLength(3)]),this.personLastName=new s.c("",[s.n.required,s.n.minLength(1)]),this.personPhoneNumber=new s.c("",[s.n.required,s.n.minLength(10),s.n.pattern(/^[+)(\d)]+$/)]),this.personEmailAddress=new s.c("",[s.n.required,s.n.minLength(1),s.n.email])}}var a=o("t0hA"),u=o("8Y7J"),h=o("h80k");function d(n,e){if(1&n&&(u.Qb(0,"div"),u.sc(1),u.Pb()),2&n){const n=e.ngIf;u.Ab(1),u.tc(" ",n," ")}}function g(n,e){if(1&n&&(u.Qb(0,"div"),u.Qb(1,"ion-button",20),u.Lb(2,"ion-icon",21),u.sc(3," Add Person to Booking "),u.Pb(),u.Qb(4,"button",22),u.Lb(5,"ion-icon",23),u.sc(6," Add Person (enter) "),u.Pb(),u.Pb()),2&n){const n=u.cc();u.Ab(1),u.hc("disabled",n.bookingForm.invalid),u.Ab(3),u.hc("disabled",n.bookingForm.invalid)}}function m(n,e){if(1&n){const n=u.Rb();u.Qb(0,"div"),u.Qb(1,"ion-button",24),u.Yb("click",(function(e){u.lc(n);const o=u.cc(),i=u.kc(8);return o.clickSubmitForm(o.bookingEnglishUUID,i,e)})),u.sc(2," Register for Sunday service (English hall) "),u.Pb(),u.Pb()}if(2&n){const n=u.cc();u.Ab(1),u.hc("disabled",n.bookingForm.invalid)}}function p(n,e){1&n&&u.sc(0," Registrations reached maximum capacity for English hall ")}function f(n,e){if(1&n){const n=u.Rb();u.Qb(0,"div"),u.Qb(1,"ion-button",24),u.Yb("click",(function(e){u.lc(n);const o=u.cc(),i=u.kc(8);return o.clickSubmitForm(o.bookingChineseUUID,i,e)})),u.sc(2," Register for Sunday service (Chinese hall) "),u.Pb(),u.Pb()}if(2&n){const n=u.cc();u.Ab(1),u.hc("disabled",n.bookingForm.invalid)}}function C(n,e){1&n&&u.sc(0," Registrations reached maximum capacity for Chinese hall ")}const P=[{path:"",component:(()=>{class n{constructor(n,e,o){this.bookingService=n,this.formBuilder=e,this.toastController=o,this.bookingChineseUUID="445538f0-e22e-4568-acf8-9bc5bba3ceb6",this.bookingEnglishUUID="81508052-8691-4ff4-a3ef-c36bf7fccc88",this.eventChineseUUID="667c1a54-3c59-4eff-a507-b55a80094249",this.eventEnglishUUID="f883134b-661a-4388-b677-582bc2ea39aa",this.latestPersonsEnglishCap=49,this.latestPersonsChineseCap=49;const i=e.group(class{static createPersonForm(){return new l}}.createPersonForm());this.bookingForm=i}get isEnglishCountCappedLocked(){return this.englishCount>=this.latestPersonsEnglishCap}get isChineseCountCappedLocked(){return this.chineseCount>=this.latestPersonsChineseCap}get isRegistrationAllowedEnglishCountBelowCap(){return!this.isEnglishCountCappedLocked}get isRegistrationAllowedChineseCountBelowCap(){return!this.isChineseCountCappedLocked}ngOnInit(){console.log("BookingPage -> ngOnInit");const n=Object(a.b)(this.bookingService.getNumberOfPersonBookingsForEvent());this.latestPersonsCountChinese=n,n.subscribe(n=>{this.chineseCount=n});const e=Object(a.b)(this.bookingService.getNumberOfPersonBookingsForEvent(this.eventEnglishUUID));this.latestPersonsCountEnglish=e,e.subscribe(n=>this.englishCount=n)}clickSubmitForm(n="445538f0-e22e-4568-acf8-9bc5bba3ceb6",e,o,i=this.bookingForm,t=this.bookingService){n===this.bookingEnglishUUID?this.englishCount+=1:this.chineseCount+=1,console.log("BookingPage:: clickSubmitForm() -> form",e,o,i);const s=i.value;""!==s.personFirstName?t.addPersonToBookingByUUID(n,s).subscribe(n=>{var e,o,i,t;console.log("BookingPage -> clickSubmitForm -> personBookingResult",n),this.presentToast("Successfully saved booking "+(null===(t=null===(i=null===(o=null===(e=null==n?void 0:n.data)||void 0===e?void 0:e.insert_Person)||void 0===o?void 0:o.returning)||void 0===i?void 0:i[0])||void 0===t?void 0:t.personFirstName)).catch()},n=>{this.presentToast("Error saving "+JSON.stringify(n)).catch()}):this.presentToast("Invalid inputs detected").catch()}presentToast(n="Loading...",e=this.toastController){return Object(b.a)(this,void 0,void 0,(function*(){return(yield e.create({message:n,duration:3500,animated:!0,translucent:!0})).present().then(()=>{console.log("Toast presented")})}))}compare(n,e){return n<e}}return n.\u0275fac=function(e){return new(e||n)(u.Kb(a.a),u.Kb(s.b),u.Kb(r.y))},n.\u0275cmp=u.Eb({type:n,selectors:[["app-booking"]],decls:52,vars:19,consts:[[3,"translucent"],["color","cobaltblue"],["slot","start"],[2,"padding-inline-start","0.25em"],[3,"formGroup"],["f","ngForm"],[3,"fixed"],[4,"ngIf"],["size","3"],["lines","full"],["position","floating"],["formControlName","personFirstName","type","text","required",""],["formControlName","personLastName","type","text","required",""],["formControlName","personPhoneNumber","type","text","required",""],["size","4.5"],["formControlName","personEmailAddress","type","text","required",""],["maxedOut",""],[4,"ngIf","ngIfElse"],["maxedEnglish",""],["maxedChinese",""],["type","button","color","cobaltblue",3,"disabled"],["name","person-add-outline"],["type","button","mat-button","","color","primary","hidden","",3,"disabled"],["name","document-text"],["type","button","color","brightnavyblue",3,"disabled","click"]],template:function(n,e){if(1&n&&(u.Qb(0,"ion-header",0),u.Qb(1,"ion-toolbar",1),u.Qb(2,"ion-buttons",2),u.Lb(3,"app-home-button"),u.Pb(),u.Qb(4,"ion-title",3),u.sc(5," Booking "),u.Pb(),u.Pb(),u.Pb(),u.Qb(6,"ion-content"),u.Qb(7,"form",4,5),u.Qb(9,"ion-grid",6),u.Qb(10,"ion-row"),u.Qb(11,"ion-col"),u.qc(12,d,2,1,"div",7),u.dc(13,"async"),u.sc(14),u.dc(15,"async"),u.Lb(16,"br"),u.sc(17),u.dc(18,"async"),u.Pb(),u.Pb(),u.Qb(19,"ion-row"),u.Qb(20,"ion-col",8),u.Qb(21,"ion-item",9),u.Qb(22,"ion-label",10),u.sc(23," First name "),u.Pb(),u.Lb(24,"ion-input",11),u.Pb(),u.Pb(),u.Pb(),u.Qb(25,"ion-row"),u.Qb(26,"ion-col",8),u.Qb(27,"ion-item",9),u.Qb(28,"ion-label",10),u.sc(29," Last name "),u.Pb(),u.Lb(30,"ion-input",12),u.Pb(),u.Pb(),u.Pb(),u.Qb(31,"ion-row"),u.Qb(32,"ion-col",8),u.Qb(33,"ion-item",9),u.Qb(34,"ion-label",10),u.sc(35," Phone number "),u.Pb(),u.Lb(36,"ion-input",13),u.Pb(),u.Pb(),u.Pb(),u.Qb(37,"ion-row"),u.Qb(38,"ion-col",14),u.Qb(39,"ion-item",9),u.Qb(40,"ion-label",10),u.sc(41," Email address "),u.Pb(),u.Lb(42,"ion-input",15),u.Pb(),u.Pb(),u.Pb(),u.qc(43,g,7,2,"div",7),u.Mb(44,null,16),u.qc(46,m,3,1,"div",17),u.qc(47,p,1,0,"ng-template",null,18,u.rc),u.qc(49,f,3,1,"div",17),u.qc(50,C,1,0,"ng-template",null,19,u.rc),u.Pb(),u.Pb(),u.Pb()),2&n){const n=u.kc(48),o=u.kc(51);u.hc("translucent",!0),u.Ab(7),u.hc("formGroup",e.bookingForm),u.Ab(2),u.hc("fixed",!0),u.Ab(3),u.hc("ngIf",u.ec(13,13,e.latestPersonsCountEnglish)),u.Ab(2),u.uc(" Current English hall registration count: ",u.ec(15,15,e.latestPersonsCountEnglish)," out of maximum ",e.latestPersonsEnglishCap," "),u.Ab(3),u.uc(" Current Chinese hall registration count: ",u.ec(18,17,e.latestPersonsCountChinese)," out of maximum ",e.latestPersonsChineseCap," "),u.Ab(26),u.hc("ngIf",e.isRegistrationAllowedEnglishCountBelowCap&&e.isRegistrationAllowedChineseCountBelowCap),u.Ab(3),u.hc("ngIf",e.isRegistrationAllowedEnglishCountBelowCap)("ngIfElse",n),u.Ab(3),u.hc("ngIf",e.isRegistrationAllowedChineseCountBelowCap)("ngIfElse",o)}},directives:[r.h,r.t,r.c,h.a,r.s,r.e,s.o,s.k,s.e,r.g,r.n,r.d,t.j,r.k,r.l,r.j,r.x,s.j,s.d,s.m,r.b,r.i],pipes:[t.b],styles:[""]}),n})()}];let k=(()=>{class n{}return n.\u0275mod=u.Ib({type:n}),n.\u0275inj=u.Hb({factory:function(e){return new(e||n)},imports:[[c.i.forChild(P)],c.i]}),n})(),v=(()=>{class n{}return n.\u0275mod=u.Ib({type:n}),n.\u0275inj=u.Hb({factory:function(e){return new(e||n)},imports:[[t.c,s.f,s.l,r.u,i.a,k]]}),n})()}}]);