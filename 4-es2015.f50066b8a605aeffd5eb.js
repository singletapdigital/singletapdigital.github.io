(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{eNtl:function(e,o,n){"use strict";n.r(o),n.d(o,"BookingPageModule",(function(){return v}));var i=n("pMoy"),t=n("UKGz"),s=n("SVse"),r=n("s7LF"),b=n("sZkV"),c=n("iInd"),a=n("mrSG");class l{constructor(){this.personFirstName=new r.c("",[r.n.required,r.n.minLength(3)]),this.personLastName=new r.c("",[r.n.required,r.n.minLength(1)]),this.personPhoneNumber=new r.c("",[r.n.required,r.n.minLength(10),r.n.pattern(/^[+)(\d)]+$/)]),this.personEmailAddress=new r.c("",[r.n.required,r.n.minLength(1),r.n.email]),this.isDeclarationChecked=new r.c("",[r.n.requiredTrue])}}class u{static createPersonForm(){return new l}}var h=n("t0hA"),d=n("8Y7J"),m=n("h80k");function g(e,o){if(1&e&&(d.Qb(0,"div"),d.Qb(1,"ion-button",26),d.Lb(2,"ion-icon",27),d.sc(3," Add Person to Booking "),d.Pb(),d.Qb(4,"button",28),d.Lb(5,"ion-icon",29),d.sc(6," Add Person (enter) "),d.Pb(),d.Pb()),2&e){const e=d.cc();d.Ab(1),d.hc("disabled",e.bookingForm.invalid),d.Ab(3),d.hc("disabled",e.bookingForm.invalid)}}function p(e,o){if(1&e){const e=d.Rb();d.Qb(0,"div"),d.Qb(1,"ion-button",30),d.Yb("click",(function(o){d.lc(e);const n=d.cc(),i=d.kc(8);return n.clickSubmitForm(n.bookingEnglishUUID,i,o)})),d.sc(2," Register for Sunday service (English hall) "),d.Pb(),d.Pb()}if(2&e){const e=d.cc();d.Ab(1),d.hc("disabled",e.bookingForm.invalid)}}function P(e,o){1&e&&(d.Qb(0,"ion-text",31),d.sc(1," Registrations reached maximum capacity for English hall "),d.Pb())}function f(e,o){if(1&e){const e=d.Rb();d.Qb(0,"div"),d.Qb(1,"ion-button",30),d.Yb("click",(function(o){d.lc(e);const n=d.cc(),i=d.kc(8);return n.clickSubmitForm(n.bookingChineseUUID,i,o)})),d.sc(2," Register for Sunday service (Chinese hall) "),d.Pb(),d.Pb()}if(2&e){const e=d.cc();d.Ab(1),d.hc("disabled",e.bookingForm.invalid)}}function C(e,o){1&e&&(d.Qb(0,"ion-text",31),d.sc(1," Registrations reached maximum capacity for Chinese hall "),d.Pb())}const Q=[{path:"",component:(()=>{class e{constructor(e,o,n){this.bookingService=e,this.formBuilder=o,this.toastController=n,this.bookingChineseUUID="445538f0-e22e-4568-acf8-9bc5bba3ceb6",this.bookingEnglishUUID="81508052-8691-4ff4-a3ef-c36bf7fccc88",this.eventChineseUUID="667c1a54-3c59-4eff-a507-b55a80094249",this.eventEnglishUUID="f883134b-661a-4388-b677-582bc2ea39aa",this.latestPersonsEnglishCap=49,this.latestPersonsChineseCap=49;const i=o.group(u.createPersonForm());this.bookingForm=i}get isEnglishCountCappedLocked(){return this.englishCount>=this.latestPersonsEnglishCap}get isChineseCountCappedLocked(){return this.chineseCount>=this.latestPersonsChineseCap}get isRegistrationAllowedEnglishCountBelowCap(){return!this.isEnglishCountCappedLocked}get isRegistrationAllowedChineseCountBelowCap(){return!this.isChineseCountCappedLocked}ngOnInit(){console.log("BookingPage -> ngOnInit");const e=Object(h.b)(this.bookingService.getNumberOfPersonBookingsForEvent());this.latestPersonsCountChinese=e,e.subscribe(e=>{this.chineseCount=e});const o=Object(h.b)(this.bookingService.getNumberOfPersonBookingsForEvent(this.eventEnglishUUID));this.latestPersonsCountEnglish=o,o.subscribe(e=>this.englishCount=e)}clickSubmitForm(e="445538f0-e22e-4568-acf8-9bc5bba3ceb6",o,n,i=this.bookingForm,t=this.bookingService){e===this.bookingEnglishUUID?this.englishCount+=1:this.chineseCount+=1,console.log("BookingPage:: clickSubmitForm() -> form",o,n,i);const s=i.value;""!==s.personFirstName?(o.control.setErrors({invalid:"Saving form..."}),t.addPersonToBookingByUUID(e,s).subscribe(e=>{var o,n,i,t;console.log("BookingPage -> clickSubmitForm -> personBookingResult",e),this.presentToast("Successfully saved booking "+(null===(t=null===(i=null===(n=null===(o=null==e?void 0:e.data)||void 0===o?void 0:o.insert_Person)||void 0===n?void 0:n.returning)||void 0===i?void 0:i[0])||void 0===t?void 0:t.personFirstName)).catch(),this.resetRecreateForm()},e=>{this.presentToast("Error saving "+JSON.stringify(e)).catch()})):this.presentToast("Invalid inputs detected").catch()}resetRecreateForm(){const e=this.formBuilder.group(u.createPersonForm());this.bookingForm=e}presentToast(e="Loading...",o=this.toastController){return Object(a.a)(this,void 0,void 0,(function*(){return(yield o.create({message:e,duration:3500,animated:!0,translucent:!0})).present().then(()=>{console.log("Toast presented")})}))}compare(e,o){return e<o}}return e.\u0275fac=function(o){return new(o||e)(d.Kb(h.a),d.Kb(r.b),d.Kb(b.B))},e.\u0275cmp=d.Eb({type:e,selectors:[["app-booking"]],decls:96,vars:16,consts:[[3,"translucent"],["color","cobaltblue"],["slot","start"],[2,"padding-inline-start","0.25em"],[3,"formGroup"],["f","ngForm"],[3,"fixed"],[2,"color","gray"],[2,"--inner-border-width","0"],[2,"text-indent","1em"],[2,"padding-left","1em"],["name","call-outline"],["aria-label","b","formControlName","isDeclarationChecked",2,"padding-left","0.95em"],["size","3"],["lines","full"],["position","floating"],["formControlName","personFirstName","type","text","required",""],["formControlName","personLastName","type","text","required",""],["formControlName","personPhoneNumber","type","text","required",""],["size","4.5"],["formControlName","personEmailAddress","type","text","required",""],[4,"ngIf"],["maxedOut",""],[4,"ngIf","ngIfElse"],["maxedEnglish",""],["maxedChinese",""],["type","button","color","cobaltblue",3,"disabled"],["name","person-add-outline"],["type","button","mat-button","","color","primary","hidden","",3,"disabled"],["name","document-text"],["type","button","color","brightnavyblue",3,"disabled","click"],["color","warning"]],template:function(e,o){if(1&e&&(d.Qb(0,"ion-header",0),d.Qb(1,"ion-toolbar",1),d.Qb(2,"ion-buttons",2),d.Lb(3,"app-home-button"),d.Pb(),d.Qb(4,"ion-title",3),d.sc(5," Booking "),d.Pb(),d.Pb(),d.Pb(),d.Qb(6,"ion-content"),d.Qb(7,"form",4,5),d.Qb(9,"ion-grid",6),d.Qb(10,"ion-row",7),d.Qb(11,"ion-col"),d.sc(12),d.dc(13,"async"),d.Lb(14,"br"),d.sc(15),d.dc(16,"async"),d.Pb(),d.Pb(),d.Qb(17,"ion-row"),d.Qb(18,"ion-col"),d.Qb(19,"ion-card"),d.Qb(20,"ion-card-header"),d.sc(21," Please review the following questions: "),d.Pb(),d.Qb(22,"ion-list"),d.Qb(23,"ion-card"),d.Qb(24,"ion-item",8),d.sc(25," 1. In the last 14 days have you travelled from overseas or a COVID-19 hotspot? "),d.Pb(),d.Qb(26,"ion-item"),d.Qb(27,"span",9),d.sc(28," \u5728\u904e\u53bb\u7684 14 \u5929\u4e2d\uff0c\u60a8\u662f\u5f9e\u6d77\u5916, \u9084\u662f\u5f9e COVID-19 \u71b1\u9ede\u56de\u6765? "),d.Pb(),d.Pb(),d.Pb(),d.Qb(29,"ion-card"),d.Qb(30,"ion-item",8),d.sc(31," 2. Have you been in close contact with a person who is positive for COVID-19? "),d.Pb(),d.Qb(32,"ion-item"),d.Qb(33,"span",9),d.sc(34," \u60a8\u662f\u5426\u8207COVID-19\u68c0\u6d4b\u5448\u967d\u6027\u7684\u4eba\u4fdd\u6301\u5bc6\u5207\u806f\u7e6b? "),d.Pb(),d.Pb(),d.Pb(),d.Qb(35,"ion-card"),d.Qb(36,"ion-item",8),d.sc(37," 3. Are you an active COVID-19 case? "),d.Pb(),d.Qb(38,"ion-item"),d.Qb(39,"span",9),d.sc(40," \u60a8\u662f\u5426\u60a3\u65b0\u51a0\u75c5\u6bd2COVID-19? "),d.Pb(),d.Pb(),d.Pb(),d.Qb(41,"ion-card"),d.Qb(42,"ion-item",8),d.sc(43," 4. Are you currently experiencing, or have you recently experienced cough, fever, sore throat, fatigue or shortness of breath? "),d.Pb(),d.Qb(44,"ion-item"),d.Qb(45,"span",9),d.sc(46," \u60a8\u76ee\u524d\u6216\u6700\u8fd1\u662f\u5426\u6709\u54b3\u55fd\uff0c\u767c\u71d2\uff0c\u5589\u56a8\u75db\uff0c\u75b2\u52de\u6216\u547c\u5438\u6025\u4fc3? "),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Pb(),d.Qb(47,"ion-row"),d.Qb(48,"ion-col"),d.Qb(49,"span",10),d.sc(50," If yes to any of the above please do not attend church service this week ( "),d.Lb(51,"ion-icon",11),d.sc(52,"13 HEALTH). "),d.Pb(),d.Pb(),d.Pb(),d.Qb(53,"ion-row"),d.Qb(54,"ion-col"),d.Qb(55,"mat-checkbox",12),d.sc(56," By checking this box I declare that I do not have any of these risk factors. "),d.Pb(),d.Pb(),d.Pb(),d.Qb(57,"ion-row"),d.Qb(58,"ion-col",13),d.Qb(59,"ion-item",14),d.Qb(60,"ion-label",15),d.sc(61," First name "),d.Pb(),d.Lb(62,"ion-input",16),d.Pb(),d.Pb(),d.Pb(),d.Qb(63,"ion-row"),d.Qb(64,"ion-col",13),d.Qb(65,"ion-item",14),d.Qb(66,"ion-label",15),d.sc(67," Last name "),d.Pb(),d.Lb(68,"ion-input",17),d.Pb(),d.Pb(),d.Pb(),d.Qb(69,"ion-row"),d.Qb(70,"ion-col",13),d.Qb(71,"ion-item",14),d.Qb(72,"ion-label",15),d.sc(73," Phone number "),d.Pb(),d.Lb(74,"ion-input",18),d.Pb(),d.Pb(),d.Pb(),d.Qb(75,"ion-row"),d.Qb(76,"ion-col",19),d.Qb(77,"ion-item",14),d.Qb(78,"ion-label",15),d.sc(79," Email address "),d.Pb(),d.Lb(80,"ion-input",20),d.Pb(),d.Pb(),d.Pb(),d.Qb(81,"ion-row"),d.Qb(82,"ion-col"),d.qc(83,g,7,2,"div",21),d.Pb(),d.Pb(),d.Qb(84,"ion-row"),d.Qb(85,"ion-col"),d.Mb(86,null,22),d.qc(88,p,3,1,"div",23),d.qc(89,P,2,0,"ng-template",null,24,d.rc),d.Pb(),d.Pb(),d.Qb(91,"ion-row"),d.Qb(92,"ion-col"),d.qc(93,f,3,1,"div",23),d.Pb(),d.Pb(),d.qc(94,C,2,0,"ng-template",null,25,d.rc),d.Pb(),d.Pb(),d.Pb()),2&e){const e=d.kc(90),n=d.kc(95);d.hc("translucent",!0),d.Ab(7),d.hc("formGroup",o.bookingForm),d.Ab(2),d.hc("fixed",!0),d.Ab(3),d.uc(" Current English hall registration count: ",d.ec(13,12,o.latestPersonsCountEnglish)," out of maximum ",o.latestPersonsEnglishCap," "),d.Ab(3),d.uc(" Current Chinese hall registration count: ",d.ec(16,14,o.latestPersonsCountChinese)," out of maximum ",o.latestPersonsChineseCap," "),d.Ab(68),d.hc("ngIf",o.isRegistrationAllowedEnglishCountBelowCap&&o.isRegistrationAllowedChineseCountBelowCap),d.Ab(5),d.hc("ngIf",o.isRegistrationAllowedEnglishCountBelowCap)("ngIfElse",e),d.Ab(5),d.hc("ngIf",o.isRegistrationAllowedChineseCountBelowCap)("ngIfElse",n)}},directives:[b.j,b.w,b.c,m.a,b.v,b.g,r.o,r.k,r.e,b.i,b.q,b.f,b.d,b.e,b.o,b.m,b.k,i.a,r.j,r.d,b.n,b.l,b.A,r.m,s.j,b.b,b.u],pipes:[s.b],styles:[""]}),e})()}];let k=(()=>{class e{}return e.\u0275mod=d.Ib({type:e}),e.\u0275inj=d.Hb({factory:function(o){return new(o||e)},imports:[[c.i.forChild(Q)],c.i]}),e})(),v=(()=>{class e{}return e.\u0275mod=d.Ib({type:e}),e.\u0275inj=d.Hb({factory:function(o){return new(o||e)},imports:[[s.c,r.f,r.l,b.x,t.a,i.b,k]]}),e})()}}]);