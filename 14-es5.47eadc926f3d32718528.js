!function(){function e(e){if(null==e)throw new TypeError("Cannot destructure undefined")}function n(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return t(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}function o(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function a(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e,n,t){return n&&a(e.prototype,n),t&&a(e,t),e}function r(){var e=v(['\n  mutation CreateEvents(\n    $eventInsertObjects: [Event_insert_input!]! = [\n      {\n        EventSeries: { data: { eventSeriesDetails: "Sunday service (English)", eventSeriesName: "Sunday worship" } }\n        Organiser: { data: { randomUUID: "b669fc76-3130-4c4e-a04e-49e9f067ea9c" } }\n      }\n    ]\n  ) {\n    insert_Event(objects: $eventInsertObjects) {\n      affected_rows\n      returning {\n        eventName\n        eventCapacity\n        eventStartDateTime\n        eventEndDateTime\n        bookingAvailableStartDateTime\n        bookingAvailableEndDateTime\n      }\n    }\n  }\n']);return r=function(){return e},e}function c(){var e=v(["\n  mutation CreateEvent($eventInsertObject: Event_insert_input! = {}) {\n    insert_Event_one(object: $eventInsertObject) {\n      randomUUID\n      bookingAvailableStartDateTime\n      bookingAvailableEndDateTime\n      eventStartDateTime\n      eventEndDateTime\n      eventDateTimeRange\n      bookingAvailabilityDateTimeRange\n      eventName\n      eventTopic\n      eventCategory\n      eventCapacity\n      eventDescription\n      eventMedium\n    }\n  }\n"]);return c=function(){return e},e}function s(){var e=v(['\n  # Get all future events.\n  # Default just in case dumb hasura behaviour doesn\'t return EventRooms but somehow returns Events depending on presence of comparison exp\n  subscription GetAllEvents($eventEndDateTimeGreaterThanEqual: timestamptz = "2020-07-28") {\n    Event(where: { eventEndDateTime: { _gte: $eventEndDateTimeGreaterThanEqual } }, limit: 20) {\n      eventName\n      eventDescription\n      eventCapacity\n      eventStartDateTime\n      eventEndDateTime\n      bookingAvailableStartDateTime\n      bookingAvailableEndDateTime\n      randomUUID\n      updated_at\n      EventRooms {\n        roomName\n        eventRoomUUID\n        eventRoomDetails\n      }\n    }\n  }\n']);return s=function(){return e},e}function v(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{oirr:function(t,a,v){"use strict";v.r(a),v.d(a,"EventsPageModule",(function(){return $}));var l,u=v("UKGz"),m=v("SVse"),b=v("s7LF"),d=v("sZkV"),g=v("iInd"),f=v("LRne"),p=v("lJxs"),E=v("pLZG"),h=v("ZTNX"),D=v("8Y7J"),y=v("RXPq"),T=v("lTCR"),k=v.n(T),O=v("IxO4"),j=v("Ok9p"),I=v("nbgS"),S=k.a(s()),_=k.a(c()),w=k.a(r()),R=((l=function(){function e(n){o(this,e),this.apollo=n,console.log("EventService -> constructor ")}return i(e,[{key:"getEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(h.e)(),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.apollo;return n.subscribe({query:S,fetchPolicy:"cache-first",variables:{eventEndDateTimeGreaterThanEqual:e}})}},{key:"getSeedEventInputObjects",value:function(){var e,t=Object(O.d)(m.o.Sunday,9,0),o=Object(O.d)(m.o.Sunday,10,30),a=Object(O.d)(m.o.Wednesday,0,0),i=Object(O.d)(m.o.Sunday,23,59,59,999),r=Object(O.c)(t,o,a,i);console.log("EventService -> getSeedEventInputObjects -> recurringDates",r);var c=r.map((function(e){var n=e.eventStartEndDateTime,t=n.startDateTime,o=n.endDateTime,a=n.startEndDateTimeRangeTstzRangeText,i=e.bookingStartEndDateTime,r=i.startDateTime,c=i.endDateTime,s=i.startEndDateTimeRangeTstzRangeText;return[C("English hall","English hall for live stream and in-person services",r,c,s,t,o,a,"Sunday service",40,"Description of community event","Church"),C("Chinese hall","Chinese main hall for live stream and in-person services",r,c,s,t,o,a,"\u4e3b\u65e5\u5d07\u62dc",40,"Description of community event","Church")]}));return(e=[]).concat.apply(e,n(c))}},{key:"createEvents",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.apollo;return n.mutate({mutation:w,variables:{eventInsertObjects:e}})}},{key:"createEvent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.apollo,n=new Date,t=new Date(n.getTime()-Object(O.a)(2)),o=new Date(n.getTime()+Object(O.a)(7)),a=new Date(n.getTime()+Object(O.a)(9)),i=new Date(n.getTime()+Object(O.a)(10)),r=(new Date(n.getTime()+Object(O.a)(10)),C("English hall","English hall for live stream and in-person services",t,o,Object(O.b)(t,o),a,i,Object(O.b)(a,i)));return console.log("EventService -> constructor -> eventInsertObject",r),e.mutate({mutation:_,variables:{eventInsertObject:r}})}}]),e}()).\u0275fac=function(e){return new(e||l)(D.Qb(I.b))},l.\u0275prov=D.Fb({token:l,factory:l.\u0275fac,providedIn:"root"}),l);function C(e,n,t,o,a,i,r,c){var s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"Sunday service",v=arguments.length>9&&void 0!==arguments[9]?arguments[9]:40,l=arguments.length>10&&void 0!==arguments[10]?arguments[10]:"Description of community event",u=arguments.length>11&&void 0!==arguments[11]?arguments[11]:"Church",m=arguments.length>12&&void 0!==arguments[12]?arguments[12]:"b669fc76-3130-4c4e-a04e-49e9f067ea9c";return{bookingAvailableStartDateTime:t,bookingAvailableEndDateTime:o,bookingAvailabilityDateTimeRange:a,eventStartDateTime:i,eventEndDateTime:r,eventDateTimeRange:c,eventName:s,eventTopic:"Topic",eventMedium:"In-person",eventCategory:u,eventCapacity:v,eventDescription:l,Organiser:{data:{randomUUID:m,organiserDetails:""},on_conflict:{constraint:j.g.Organiser_randomUUID_key,update_columns:[j.h.updated_at]}},EventRooms:{data:[{eventRoomDetails:n,Room:{data:{roomName:e,roomType:"Hall",roomCapacity:49,Venue:{data:{venueName:"Eight Mile Plains Chinese Methodist Church",randomUUID:"9cb826dc-fcf8-406e-8b01-f4eba15dfcc6"},on_conflict:{constraint:j.o.Venue_randomUUID_key,update_columns:[j.p.updated_at]}}},on_conflict:{constraint:j.k.Room_venueID_roomName_key,update_columns:[j.l.updated_at]}}}],on_conflict:{constraint:j.c.EventRoom_eventRoomID_eventID_roomID_venueID_roomName_event_key,update_columns:[j.d.updated_at]}}}}var U=v("t0hA"),M=v("Y+pZ");function A(e,n){if(1&e){var t=D.Nb();D.Mb(0,"ion-item-sliding"),D.Mb(1,"ion-item-options"),D.Mb(2,"ion-item-option",2),D.nc(3,"Check "),D.Lb(),D.Lb(),D.Mb(4,"ion-item",3),D.Ub("click",(function(e){D.ic(t);var o=n.$implicit;return D.Yb().clickEventItem(e,o)})),D.Mb(5,"ion-avatar",4),D.Kb(6,"img",5),D.Lb(),D.Mb(7,"ion-label"),D.Mb(8,"h2"),D.nc(9),D.Lb(),D.Mb(10,"h3"),D.nc(11),D.Lb(),D.Mb(12,"p"),D.nc(13),D.Zb(14,"date"),D.Zb(15,"date"),D.Lb(),D.Lb(),D.Lb(),D.Lb()}if(2&e){var o=n.$implicit;D.zb(9),D.oc(null==o?null:o.eventName),D.zb(2),D.oc(null==o||null==o.EventRooms[0]?null:o.EventRooms[0].roomName),D.zb(2),D.qc(" ",D.bc(14,4,o.eventStartDateTime,"EEEE',' dd MMM HH:mm"),"\u2013",D.bc(15,7,o.eventEndDateTime,"HH:mm")," ")}}var L,P,N,z=[{path:"",component:(L=function(){function n(e,t,a,i){o(this,n),this.router=e,this.pwaService=t,this.eventService=a,this.bookingService=i,this.upcomingEvents=Object(f.a)([]),console.log("EventsPage:: constructor")}return i(n,[{key:"ngOnInit",value:function(){console.log("EventsPage:: ngOnInit"),this.upcomingEvents=this.getLatestEvents()}},{key:"getLatestEvents",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.eventService;return console.log("EventsPage:: getLatestEvents"),n.getEvents().pipe(Object(p.a)((function(n){e(n.data);var t=n.errors;if(console.log("EventsPage -> eventsResult",n),!((null==t?void 0:t.length)>0))return console.log("%c EventsPage:: subscribeLatestEvents -> events",h.a),n.data.Event})),Object(E.a)((function(e){var n,t,o;return void 0!==e&&void 0!==(null===(n=e[0])||void 0===n?void 0:n.EventRooms)&&void 0!==(null===(o=null===(t=e[0])||void 0===t?void 0:t.EventRooms[0])||void 0===o?void 0:o.roomName)})))}},{key:"clickEventItem",value:function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.router;console.log("EventsPage -> eventItemClick -> eventItemClick",e),console.log("EventsPage -> eventItemClick -> event",n.randomUUID),this.navigateToBooking(n,t)}},{key:"navigateToBooking",value:function(e,n){n.navigate(["/booking"],{state:e}).then((function(e){console.log("EventsPage -> clickEventItem -> navigated ",e)})).catch((function(e){console.log("EventsPage -> clickEventItem -> navigate error",e)}))}},{key:"clickTestButton",value:function(e){console.log("EventsPage -> testButton -> event",e),this.seedEvents()}},{key:"seedEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.eventService,n=e.getSeedEventInputObjects();console.log("EventsPage -> seedEvents -> getSeedEventInputObjects",n),e.createEvents(n).subscribe((function(e){console.log("EventsPage -> seedEvents -> createdEventsResult",e)}))}}]),n}(),L.\u0275fac=function(e){return new(e||L)(D.Jb(g.g),D.Jb(y.a),D.Jb(R),D.Jb(U.a))},L.\u0275cmp=D.Db({type:L,selectors:[["app-events"]],decls:7,vars:3,consts:[["pageTitle","COVIDSafe Events"],[4,"ngFor","ngForOf"],["color","danger"],["button","",3,"click"],["slot","start"],["src","/assets/images/emp-cmca-logo-small-172x172-placeholder.jpg","alt","Placeholder-image-church"]],template:function(e,n){1&e&&(D.Kb(0,"app-custom-header",0),D.Mb(1,"ion-content"),D.Mb(2,"ion-list"),D.Mb(3,"ion-list-header"),D.nc(4,"Upcoming events"),D.Lb(),D.lc(5,A,16,10,"ion-item-sliding",1),D.Zb(6,"async"),D.Lb(),D.Lb()),2&e&&(D.zb(5),D.ec("ngForOf",D.ac(6,1,n.upcomingEvents)))},directives:[M.a,d.j,d.t,d.u,m.j,d.r,d.q,d.p,d.o,d.b,d.s],pipes:[m.b,m.e],styles:[""]}),L)}],G=((N=function e(){o(this,e)}).\u0275mod=D.Hb({type:N}),N.\u0275inj=D.Gb({factory:function(e){return new(e||N)},imports:[[g.i.forChild(z)],g.i]}),N),$=((P=function e(){o(this,e)}).\u0275mod=D.Hb({type:P}),P.\u0275inj=D.Gb({factory:function(e){return new(e||P)},imports:[[m.c,b.f,d.A,u.a,G]]}),P)}}])}();