!function(){function n(n,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,o.key,o)}}function e(e,i,o){return i&&n(e.prototype,i),o&&n(e,o),e}function i(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{eNtl:function(n,o,t){"use strict";t.r(o),t.d(o,"BookingPageModule",(function(){return I}));var s=t("UKGz"),r=t("SVse"),c=t("s7LF"),a=t("sZkV"),l=t("iInd"),b=t("mrSG"),u=function n(){i(this,n),this.personFirstName=new c.c("",[c.n.required,c.n.minLength(3)]),this.personLastName=new c.c("",[c.n.required,c.n.minLength(1)]),this.personPhoneNumber=new c.c("",[c.n.required,c.n.minLength(10),c.n.pattern(/^[+)(\d)]+$/)]),this.personEmailAddress=new c.c("",[c.n.required,c.n.minLength(1),c.n.email])},h=t("t0hA"),d=t("8Y7J"),g=t("h80k");function f(n,e){if(1&n&&(d.Qb(0,"div"),d.sc(1),d.Pb()),2&n){var i=e.ngIf;d.Ab(1),d.tc(" ",i," ")}}function m(n,e){if(1&n&&(d.Qb(0,"div"),d.Qb(1,"ion-button",20),d.Lb(2,"ion-icon",21),d.sc(3," Add Person to Booking "),d.Pb(),d.Qb(4,"button",22),d.Lb(5,"ion-icon",23),d.sc(6," Add Person (enter) "),d.Pb(),d.Pb()),2&n){var i=d.cc();d.Ab(1),d.hc("disabled",i.bookingForm.invalid),d.Ab(3),d.hc("disabled",i.bookingForm.invalid)}}function p(n,e){if(1&n){var i=d.Rb();d.Qb(0,"div"),d.Qb(1,"ion-button",24),d.Yb("click",(function(n){d.lc(i);var e=d.cc(),o=d.kc(8);return e.clickSubmitForm(e.bookingEnglishUUID,o,n)})),d.sc(2," Register for Sunday service (English hall) "),d.Pb(),d.Pb()}if(2&n){var o=d.cc();d.Ab(1),d.hc("disabled",o.bookingForm.invalid)}}function v(n,e){1&n&&d.sc(0," Registrations reached maximum capacity for English hall ")}function C(n,e){if(1&n){var i=d.Rb();d.Qb(0,"div"),d.Qb(1,"ion-button",24),d.Yb("click",(function(n){d.lc(i);var e=d.cc(),o=d.kc(8);return e.clickSubmitForm(e.bookingChineseUUID,o,n)})),d.sc(2," Register for Sunday service (Chinese hall) "),d.Pb(),d.Pb()}if(2&n){var o=d.cc();d.Ab(1),d.hc("disabled",o.bookingForm.invalid)}}function k(n,e){1&n&&d.sc(0," Registrations reached maximum capacity for Chinese hall ")}var P,y,w,Q=[{path:"",component:(P=function(){function n(o,t,s){i(this,n),this.bookingService=o,this.formBuilder=t,this.toastController=s,this.bookingChineseUUID="445538f0-e22e-4568-acf8-9bc5bba3ceb6",this.bookingEnglishUUID="81508052-8691-4ff4-a3ef-c36bf7fccc88",this.eventChineseUUID="667c1a54-3c59-4eff-a507-b55a80094249",this.eventEnglishUUID="f883134b-661a-4388-b677-582bc2ea39aa",this.latestPersonsEnglishCap=49,this.latestPersonsChineseCap=49;var r=t.group(function(){function n(){i(this,n)}return e(n,null,[{key:"createPersonForm",value:function(){return new u}}]),n}().createPersonForm());this.bookingForm=r}return e(n,[{key:"ngOnInit",value:function(){var n=this;console.log("BookingPage -> ngOnInit");var e=Object(h.b)(this.bookingService.getNumberOfPersonBookingsForEvent());this.latestPersonsCountChinese=e,e.subscribe((function(e){n.chineseCount=e}));var i=Object(h.b)(this.bookingService.getNumberOfPersonBookingsForEvent(this.eventEnglishUUID));this.latestPersonsCountEnglish=i,i.subscribe((function(e){return n.englishCount=e}))}},{key:"clickSubmitForm",value:function(){var n=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"445538f0-e22e-4568-acf8-9bc5bba3ceb6",i=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.bookingForm,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.bookingService;e===this.bookingEnglishUUID?this.englishCount+=1:this.chineseCount+=1,console.log("BookingPage:: clickSubmitForm() -> form",i,o,t);var r=t.value;""!==r.personFirstName?s.addPersonToBookingByUUID(e,r).subscribe((function(e){var i,o,t,s;console.log("BookingPage -> clickSubmitForm -> personBookingResult",e),n.presentToast("Successfully saved booking "+(null===(s=null===(t=null===(o=null===(i=null==e?void 0:e.data)||void 0===i?void 0:i.insert_Person)||void 0===o?void 0:o.returning)||void 0===t?void 0:t[0])||void 0===s?void 0:s.personFirstName)).catch()}),(function(e){n.presentToast("Error saving "+JSON.stringify(e)).catch()})):this.presentToast("Invalid inputs detected").catch()}},{key:"presentToast",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Loading...",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.toastController;return Object(b.a)(this,void 0,void 0,regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,e.create({message:n,duration:3500,animated:!0,translucent:!0});case 2:return i.abrupt("return",i.sent.present().then((function(){console.log("Toast presented")})));case 3:case"end":return i.stop()}}),i)})))}},{key:"compare",value:function(n,e){return n<e}},{key:"isEnglishCountCappedLocked",get:function(){return this.englishCount>=this.latestPersonsEnglishCap}},{key:"isChineseCountCappedLocked",get:function(){return this.chineseCount>=this.latestPersonsChineseCap}},{key:"isRegistrationAllowedEnglishCountBelowCap",get:function(){return!this.isEnglishCountCappedLocked}},{key:"isRegistrationAllowedChineseCountBelowCap",get:function(){return!this.isChineseCountCappedLocked}}]),n}(),P.\u0275fac=function(n){return new(n||P)(d.Kb(h.a),d.Kb(c.b),d.Kb(a.y))},P.\u0275cmp=d.Eb({type:P,selectors:[["app-booking"]],decls:52,vars:19,consts:[[3,"translucent"],["color","cobaltblue"],["slot","start"],[2,"padding-inline-start","0.25em"],[3,"formGroup"],["f","ngForm"],[3,"fixed"],[4,"ngIf"],["size","3"],["lines","full"],["position","floating"],["formControlName","personFirstName","type","text","required",""],["formControlName","personLastName","type","text","required",""],["formControlName","personPhoneNumber","type","text","required",""],["size","4.5"],["formControlName","personEmailAddress","type","text","required",""],["maxedOut",""],[4,"ngIf","ngIfElse"],["maxedEnglish",""],["maxedChinese",""],["type","button","color","cobaltblue",3,"disabled"],["name","person-add-outline"],["type","button","mat-button","","color","primary","hidden","",3,"disabled"],["name","document-text"],["type","button","color","brightnavyblue",3,"disabled","click"]],template:function(n,e){if(1&n&&(d.Qb(0,"ion-header",0),d.Qb(1,"ion-toolbar",1),d.Qb(2,"ion-buttons",2),d.Lb(3,"app-home-button"),d.Pb(),d.Qb(4,"ion-title",3),d.sc(5," Booking "),d.Pb(),d.Pb(),d.Pb(),d.Qb(6,"ion-content"),d.Qb(7,"form",4,5),d.Qb(9,"ion-grid",6),d.Qb(10,"ion-row"),d.Qb(11,"ion-col"),d.qc(12,f,2,1,"div",7),d.dc(13,"async"),d.sc(14),d.dc(15,"async"),d.Lb(16,"br"),d.sc(17),d.dc(18,"async"),d.Pb(),d.Pb(),d.Qb(19,"ion-row"),d.Qb(20,"ion-col",8),d.Qb(21,"ion-item",9),d.Qb(22,"ion-label",10),d.sc(23," First name "),d.Pb(),d.Lb(24,"ion-input",11),d.Pb(),d.Pb(),d.Pb(),d.Qb(25,"ion-row"),d.Qb(26,"ion-col",8),d.Qb(27,"ion-item",9),d.Qb(28,"ion-label",10),d.sc(29," Last name "),d.Pb(),d.Lb(30,"ion-input",12),d.Pb(),d.Pb(),d.Pb(),d.Qb(31,"ion-row"),d.Qb(32,"ion-col",8),d.Qb(33,"ion-item",9),d.Qb(34,"ion-label",10),d.sc(35," Phone number "),d.Pb(),d.Lb(36,"ion-input",13),d.Pb(),d.Pb(),d.Pb(),d.Qb(37,"ion-row"),d.Qb(38,"ion-col",14),d.Qb(39,"ion-item",9),d.Qb(40,"ion-label",10),d.sc(41," Email address "),d.Pb(),d.Lb(42,"ion-input",15),d.Pb(),d.Pb(),d.Pb(),d.qc(43,m,7,2,"div",7),d.Mb(44,null,16),d.qc(46,p,3,1,"div",17),d.qc(47,v,1,0,"ng-template",null,18,d.rc),d.qc(49,C,3,1,"div",17),d.qc(50,k,1,0,"ng-template",null,19,d.rc),d.Pb(),d.Pb(),d.Pb()),2&n){var i=d.kc(48),o=d.kc(51);d.hc("translucent",!0),d.Ab(7),d.hc("formGroup",e.bookingForm),d.Ab(2),d.hc("fixed",!0),d.Ab(3),d.hc("ngIf",d.ec(13,13,e.latestPersonsCountEnglish)),d.Ab(2),d.uc(" Current English hall registration count: ",d.ec(15,15,e.latestPersonsCountEnglish)," out of maximum ",e.latestPersonsEnglishCap," "),d.Ab(3),d.uc(" Current Chinese hall registration count: ",d.ec(18,17,e.latestPersonsCountChinese)," out of maximum ",e.latestPersonsChineseCap," "),d.Ab(26),d.hc("ngIf",e.isRegistrationAllowedEnglishCountBelowCap&&e.isRegistrationAllowedChineseCountBelowCap),d.Ab(3),d.hc("ngIf",e.isRegistrationAllowedEnglishCountBelowCap)("ngIfElse",i),d.Ab(3),d.hc("ngIf",e.isRegistrationAllowedChineseCountBelowCap)("ngIfElse",o)}},directives:[a.h,a.t,a.c,g.a,a.s,a.e,c.o,c.k,c.e,a.g,a.n,a.d,r.j,a.k,a.l,a.j,a.x,c.j,c.d,c.m,a.b,a.i],pipes:[r.b],styles:[""]}),P)}],E=((w=function n(){i(this,n)}).\u0275mod=d.Ib({type:w}),w.\u0275inj=d.Hb({factory:function(n){return new(n||w)},imports:[[l.i.forChild(Q)],l.i]}),w),I=((y=function n(){i(this,n)}).\u0275mod=d.Ib({type:y}),y.\u0275inj=d.Hb({factory:function(n){return new(n||y)},imports:[[r.c,c.f,c.l,a.u,s.a,E]]}),y)}}])}();