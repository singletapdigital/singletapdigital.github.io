(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{kJmD:function(e,o,t){"use strict";t.r(o),t.d(o,"BookingEventPageModule",(function(){return k}));var n=t("UKGz"),i=t("pMoy"),r=t("SVse"),s=t("s7LF"),a=t("sZkV"),c=t("iInd"),l=t("mrSG"),b=t("jp9Y"),m=t("aDUK"),d=t("8Y7J"),u=t("t0hA"),g=t("Y+pZ"),p=t("T/V+");const v=[{path:"",component:(()=>{class e{constructor(e,o,t,n,i){this.formBuilder=e,this.activatedRoute=o,this.router=t,this.toastController=n,this.bookingService=i,this.selectedEventUUID="",this.selectedEventName="",this.selectedEventCapacity=40,this.currentPersonBookingCount=0;const r=e.group(b.a.createPersonForm());this.bookingForm=r,o.queryParams.subscribe(e=>{console.log("BookingEventPage -> params",e);const o=t.getCurrentNavigation();if(null===o||void 0===o.extras.state)return void t.navigateByUrl("/").then(e=>{console.log("BookingEventPage -> reNavigate. No navExtras found to book",e)}).catch(e=>{console.log("BookingEventPage -> reNavigate error",e)});const{extras:{state:n}}=o,{randomUUID:i,eventName:r,eventCapacity:s}=n;this.selectedEventUUID=i,this.selectedEventName=r,this.selectedEventCapacity=s})}get isCapacityLocked(){return this.currentPersonBookingCount>=this.selectedEventCapacity}get isRegistrationAllowed(){return!this.isCapacityLocked}ngOnInit(){}onSubmitForm(e,o,t=this.selectedEventUUID,n=this.bookingForm,i=this.bookingService){console.log("BookingEventPage -> clickSubmitForm -> eventUUID",t,n.value);const r=n.value;e.control.setErrors({invalid:"Saving form..."}),this.presentToast().then(e=>{}).catch(e=>{}),i.bookPersonByEventUUID(t,r).subscribe(({errors:e,data:o})=>{var n;if(void 0!==e||(null==e?void 0:e.length)>0||void 0===(null===(n=o.insert_Person_one)||void 0===n?void 0:n.personFirstName))return console.log("BookingEventPage -> ngOnInit -> data",o),console.log("BookingEventPage -> ngOnInit -> errors",e),console.error("Failed to save"),void this.presentToast("Unable to book. \u{1f6a7}").then(e=>{}).catch(e=>{});const i=o.insert_Person_one,s=Object.assign({selectedEventUUID:t},r);console.log("BookingEventPage -> ngOnInit -> returnedPerson",i),console.log("BookingEventPage -> ngOnInit -> personFormSubmission",s);const a=JSON.stringify(i),c=JSON.stringify(s);console.log("BookingEventPage -> ngOnInit -> returnedPersonSuccessLocalStorageText personFormSubmissionLocalStorageText",a,c),localStorage.setItem(m.a,a),localStorage.setItem(m.b,c),this.presentToast("\u{1f516}\u{1f4d1}Booking successful \u{1f4be}\u{1f9fe}\u{1f4dd}\u{1f4da}\u{1f4d7}\u{1f4d6}").then(e=>{}).catch(e=>{})})}presentToast(e="Loading... \u{1f503}",o=this.toastController){return Object(l.a)(this,void 0,void 0,(function*(){return(yield o.create({message:e,duration:4e3,animated:!0,translucent:!0})).present().then(()=>{console.log("Toast presented")})}))}}return e.\u0275fac=function(o){return new(o||e)(d.Jb(s.b),d.Jb(c.a),d.Jb(c.g),d.Jb(a.E),d.Jb(u.a))},e.\u0275cmp=d.Db({type:e,selectors:[["app-booking-event"]],decls:38,vars:6,consts:[[3,"translucent"],["pageTitle","Book event"],[3,"formGroup","ngSubmit"],["f","ngForm"],["src","/assets/images/emp-cmca-logo-small-172x172-placeholder.jpg","alt","Placeholder-image-church"],[2,"padding-left","0.5em","margin-bottom","0em"],["position","floating"],["formControlName","personFirstName","type","text","placeholder","First name for registration, check in and contact-tracing purposes","required",""],["formControlName","personLastName","type","text","placeholder","Your last name","required",""],["formControlName","personPhoneNumber","type","tel","placeholder","0412345678","size","12","required",""],["formControlName","personEmailAddress","type","text","placeholder","info@example.com","required",""],[3,"eventName"],["type","submit","color","cobaltblue",3,"disabled","click"],["name","person-add-outline"],["type","submit","mat-button","","color","primary","hidden","",3,"disabled"],["name","document-text"]],template:function(e,o){if(1&e){const e=d.Nb();d.Mb(0,"ion-header",0),d.Kb(1,"app-custom-header",1),d.Lb(),d.Mb(2,"ion-content"),d.Mb(3,"form",2,3),d.Ub("ngSubmit",(function(t){d.ic(e);const n=d.hc(4);return o.onSubmitForm(n,t)})),d.Mb(5,"ion-list"),d.Mb(6,"ion-list-header"),d.Mb(7,"ion-avatar"),d.Kb(8,"img",4),d.Lb(),d.Mb(9,"ion-label"),d.Mb(10,"h1",5),d.nc(11),d.Lb(),d.Lb(),d.Lb(),d.Mb(12,"ion-item"),d.Mb(13,"ion-label",6),d.nc(14," First name "),d.Lb(),d.Kb(15,"ion-input",7),d.Lb(),d.Mb(16,"ion-item"),d.Mb(17,"ion-label",6),d.nc(18," Last name "),d.Lb(),d.Kb(19,"ion-input",8),d.Lb(),d.Mb(20,"ion-item"),d.Mb(21,"ion-label",6),d.nc(22," Phone number "),d.Lb(),d.Kb(23,"ion-input",9),d.Lb(),d.Mb(24,"ion-item"),d.Mb(25,"ion-label",6),d.nc(26," Email address "),d.Lb(),d.Kb(27,"ion-input",10),d.Lb(),d.Lb(),d.Kb(28,"app-covid-declaration",11),d.Mb(29,"ion-row"),d.Mb(30,"ion-col"),d.Mb(31,"div"),d.Mb(32,"ion-button",12),d.Ub("click",(function(t){d.ic(e);const n=d.hc(4);return o.onSubmitForm(n,t)})),d.Kb(33,"ion-icon",13),d.nc(34," Create Booking "),d.Lb(),d.Mb(35,"button",14),d.Kb(36,"ion-icon",15),d.nc(37," Add Person (enter) "),d.Lb(),d.Lb(),d.Lb(),d.Lb(),d.Lb(),d.Lb()}2&e&&(d.ec("translucent",!0),d.zb(3),d.ec("formGroup",o.bookingForm),d.zb(8),d.oc(o.selectedEventName),d.zb(17),d.ec("eventName",o.selectedEventName),d.zb(4),d.ec("disabled",o.bookingForm.invalid),d.zb(3),d.ec("disabled",o.bookingForm.invalid))},directives:[a.l,g.a,a.j,s.o,s.k,s.e,a.t,a.u,a.b,a.s,a.o,a.n,a.D,s.j,s.d,s.m,p.a,a.w,a.i,a.e,a.m],styles:[""]}),e})()}];let h=(()=>{class e{}return e.\u0275mod=d.Hb({type:e}),e.\u0275inj=d.Gb({factory:function(o){return new(o||e)},imports:[[c.i.forChild(v)],c.i]}),e})(),k=(()=>{class e{}return e.\u0275mod=d.Hb({type:e}),e.\u0275inj=d.Gb({factory:function(o){return new(o||e)},imports:[[r.c,s.f,s.l,a.A,n.a,i.b,h]]}),e})()}}]);