!function(){function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var o=0;o<n.length;o++){var t=n[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function o(e,o,t){return o&&n(e.prototype,o),t&&n(e,t),e}function t(){var e=i(['\n  mutation PersonCheckOut($personUUIDEquals: uuid!, $eventUUIDEquals: uuid!) {\n    update_PersonBooking(\n      _set: { checkOutDateTime: "now()" }\n      where: {\n        Person: { randomUUID: { _eq: $personUUIDEquals } }\n        Booking: { Event: { randomUUID: { _eq: $eventUUIDEquals } } }\n      }\n    ) {\n      affected_rows\n      returning {\n        checkInDateTime\n        checkOutDateTime\n        randomUUID\n        updated_at\n      }\n    }\n  }\n']);return t=function(){return e},e}function r(){var e=i(['\n  mutation PersonCheckIn($personUUIDEquals: uuid!, $eventUUIDEquals: uuid!) {\n    update_PersonBooking(\n      _set: { checkInDateTime: "now()" }\n      where: {\n        Person: { randomUUID: { _eq: $personUUIDEquals } }\n        Booking: { Event: { randomUUID: { _eq: $eventUUIDEquals } } }\n      }\n    ) {\n      affected_rows\n      returning {\n        checkInDateTime\n        checkOutDateTime\n        randomUUID\n        updated_at\n      }\n    }\n  }\n']);return r=function(){return e},e}function i(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{hRIL:function(n,i,c){"use strict";c.r(i),c.d(i,"CheckInPageModule",(function(){return S}));var a,s=c("UKGz"),l=c("SVse"),u=c("s7LF"),d=c("sZkV"),g=c("iInd"),h=c("mrSG"),v=c("aDUK"),k=c("IxO4"),b=c("8Y7J"),f=c("t0hA"),I=c("lTCR"),p=c.n(I),m=c("nbgS"),U=p.a(r()),P=p.a(t()),D=((a=function(){function n(o){e(this,n),this.apollo=o}return o(n,[{key:"checkInPersonByUUIDs",value:function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.apollo;return o.mutate({mutation:U,variables:{personUUIDEquals:e,eventUUIDEquals:n}})}},{key:"checkOutPersonByUUIDs",value:function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.apollo;return o.mutate({mutation:P,variables:{personUUIDEquals:e,eventUUIDEquals:n}})}}]),n}()).\u0275fac=function(e){return new(e||a)(b.Sb(m.b))},a.\u0275prov=b.Fb({token:a,factory:a.\u0275fac,providedIn:"root"}),a),O=c("Y+pZ");function C(e,n){if(1&e&&(b.Mb(0),b.Ob(1,"h2"),b.qc(2),b.Nb(),b.Lb()),2&e){var o=b.ac();b.zb(2),b.rc(o.personFormAutofillMostRecent.personFirstName)}}function B(e,n){if(1&e&&(b.Ob(0,"h2"),b.qc(1),b.Nb(),b.Ob(2,"h2"),b.qc(3),b.Nb()),2&e){var o=b.ac();b.zb(1),b.rc(null==o.savedPersonBooking||null==o.savedPersonBooking.PersonBookings[0]?null:o.savedPersonBooking.PersonBookings[0].Booking.Event.eventStartDateTime),b.zb(2),b.sc("PersonUUID: ",null==o.savedPersonBooking?null:o.savedPersonBooking.randomUUID,"")}}function y(e,n){1&e&&(b.Mb(0),b.qc(1," Nothing to do \ud83d\ude34. "),b.Kb(2,"br"),b.qc(3," We have already checked in or are awaiting registration. "),b.Kb(4,"br"),b.qc(5," \ud83d\udeaa\ud83e\uddf3\ud83d\udec4 "),b.Lb())}function q(e,n){if(1&e){var o=b.Pb();b.Ob(0,"ion-button",5),b.Wb("click",(function(){return b.lc(o),b.ac().onClickCheckIn()})),b.Kb(1,"ion-icon",6),b.qc(2," Check in "),b.Nb(),b.Ob(3,"ion-button",7),b.Wb("click",(function(){return b.lc(o),b.ac().onClickCheckOut()})),b.qc(4," Check out "),b.Kb(5,"ion-icon",8),b.Nb()}if(2&e){var t=b.ac();b.gc("hidden",t.isAlreadyCheckedIn||null==t.savedPersonBooking),b.zb(3),b.gc("hidden",t.isAlreadyCheckedOut||null==t.savedPersonBooking)}}var E,T,w,A=[{path:"",component:(E=function(){function n(o,t,r,i){e(this,n),this.datePipe=o,this.toastController=t,this.bookingService=r,this.checkInOutService=i,this.isAlreadyCheckedIn=!1,this.isAlreadyCheckedOut=!1,console.log("CheckInPage -> constructor -> bookingService",r),this.getLoadBookingPersonsFromLocalStorage()}return o(n,[{key:"ngOnInit",value:function(){}},{key:"getLoadBookingPersonsFromLocalStorage",value:function(){var e=Object(v.c)(),n=e.savedPersonBooking,o=e.personFormAutofillLast;this.savedPersonBooking=n,console.log("CheckInPage -> getLoadBookingPersonsFromLocalStorage -> savedPersonBooking",n),this.personFormAutofillMostRecent=o,console.log("CheckInPage -> getLoadBookingPersonsFromLocalStorage -> personFormAutofillLast",o)}},{key:"onClickCheckIn",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.savedPersonBooking,o=n.randomUUID,t=n.PersonBookings,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.personFormAutofillMostRecent,i=r.selectedEventUUID,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.checkInOutService;c.checkInPersonByUUIDs(o,i).subscribe((function(n){var o,r,i,c=n.errors,a=n.data;if(void 0!==c||(null==c?void 0:c.length)>0||void 0===a)return console.log("CheckInPage -> ngOnInit -> data",a),console.log("CheckInPage -> ngOnInit -> errors",c),void console.error(c,a);var s=null===(r=null===(o=a.update_PersonBooking.returning)||void 0===o?void 0:o[0])||void 0===r?void 0:r.checkInDateTime;console.log("Check in success",s,a);var l="\u2705Successfully checked in<br />Welcome to ".concat(null===(i=null==t?void 0:t[0])||void 0===i?void 0:i.Booking.Event.eventName,"<br />").concat(e.getDateTimeText(s));e.presentToast(l).then((function(){})).catch((function(){})),e.isAlreadyCheckedIn=!0}))}},{key:"onClickCheckOut",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.savedPersonBooking,o=n.randomUUID,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.personFormAutofillMostRecent,r=t.selectedEventUUID,i=t.personFirstName,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.checkInOutService;c.checkOutPersonByUUIDs(o,r).subscribe((function(n){var o,t,r=n.errors,c=n.data;if(void 0!==r||(null==r?void 0:r.length)>0||void 0===c)return console.log("CheckInPage -> ngOnInit -> data",c),console.log("CheckInPage -> ngOnInit -> errors",r),void console.error(r,c);var a=null===(t=null===(o=c.update_PersonBooking.returning)||void 0===o?void 0:o[0])||void 0===t?void 0:t.checkOutDateTime;console.log("Check out success",a,c);var s="\ud83c\udfc1Successfully checked out<br />Have a nice day ".concat(i,"\ud83d\ude03<br />").concat(e.getDateTimeText(a));e.presentToast(s).then((function(){})).catch((function(){})),e.isAlreadyCheckedOut=!0,Object(v.d)()}))}},{key:"presentToast",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.toastController;return Object(h.a)(this,void 0,void 0,regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,n.create({message:e,duration:3500,animated:!0,translucent:!0});case 2:return o.abrupt("return",o.sent.present().then((function(){console.log("Toast presented")})).catch((function(e){})));case 3:case"end":return o.stop()}}),o)})))}},{key:"getDateTimeText",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.datePipe;return n.transform(e,k.a)}}]),n}(),E.\u0275fac=function(e){return new(e||E)(b.Jb(l.e),b.Jb(d.I),b.Jb(f.a),b.Jb(D))},E.\u0275cmp=b.Db({type:E,selectors:[["app-check-in"]],decls:17,vars:5,consts:[["pageTitle","Check in","isRightAlignedEndButtonHidden","true"],["button",""],[4,"ngIf","ngIfElse"],["elseTemplateBookingRegisteredAvailableToCheckin",""],["elseTemplateCheckInOutISAvailable",""],["color","tetradicgreen",3,"hidden","click"],["name","log-in-outline"],["color","cobaltblue",3,"hidden","click"],["name","log-out-outline"]],template:function(e,n){if(1&e&&(b.Ob(0,"ion-header"),b.Kb(1,"app-custom-header",0),b.Nb(),b.Ob(2,"ion-content"),b.Ob(3,"ion-card"),b.Ob(4,"ion-card-content"),b.Ob(5,"ion-item",1),b.Ob(6,"ion-label"),b.qc(7," Recent booking pre-registration "),b.oc(8,C,3,1,"ng-container",2),b.oc(9,B,4,2,"ng-template",null,3,b.pc),b.Ob(11,"h3"),b.qc(12),b.Nb(),b.Nb(),b.Nb(),b.Nb(),b.Ob(13,"ion-card-content"),b.oc(14,y,6,0,"ng-container",2),b.oc(15,q,6,2,"ng-template",null,4,b.pc),b.Nb(),b.Nb(),b.Nb()),2&e){var o=b.kc(10),t=b.kc(16);b.zb(8),b.gc("ngIf",null==n.savedPersonBooking)("ngIfElse",o),b.zb(4),b.sc(" EventUUID: ",null==n.personFormAutofillMostRecent?null:n.personFormAutofillMostRecent.selectedEventUUID," "),b.zb(2),b.gc("ngIf",null==n.savedPersonBooking)("ngIfElse",t)}},directives:[d.l,O.a,d.j,d.g,d.h,d.o,d.s,l.k,d.e,d.m],styles:[""]}),E)}],N=((w=function n(){e(this,n)}).\u0275mod=b.Hb({type:w}),w.\u0275inj=b.Gb({factory:function(e){return new(e||w)},imports:[[g.i.forChild(A)],g.i]}),w),S=((T=function n(){e(this,n)}).\u0275mod=b.Hb({type:T}),T.\u0275inj=b.Gb({factory:function(e){return new(e||T)},imports:[[l.c,u.f,d.D,s.a,N]]}),T)}}])}();